max v2;#N vpatcher 53 44 799 722;#P origin 0 -4;#P window setfont "Sans Serif" 9.;#P window linecount 2;#P comment 584 600 107 196617 patch by Tom Mays contact@tommays.net;#P window linecount 1;#P newex 94 361 311 196617 bondo 6 1;#P newex 514 478 183 196617 s $1-bv_center;#B color 11;#P newex 454 498 182 196617 s $1-gu_center;#B color 11;#P newex 394 518 183 196617 s $1-ry_center;#B color 11;#P newex 394 458 131 196617 unpack i i i;#P newex 214 273 172 196617 r $1-bv_center;#B color 11;#P newex 154 251 171 196617 r $1-gu_center;#B color 11;#P newex 94 229 172 196617 r $1-ry_center;#B color 11;#P newex 394 340 188 196617 r $1-bv_tolerance;#B color 11;#P newex 334 317 187 196617 r $1-gu_tolerance;#B color 11;#P newex 274 295 188 196617 r $1-ry_tolerance;#B color 11;#P newex 57 102 212 196617 s $1_toeditor;#B color 13;#P newex 57 135 115 196617 r $1;#B color 13;#P window linecount 2;#P comment 223 387 41 196617 b or v center;#P comment 165 387 41 196617 g or u center;#P comment 280 387 49 196617 r or y tolerance;#P comment 340 387 49 196617 g or u tolerance;#P flonum 394 414 42 9 0 0 0 3 0 0 0 221 221 221 222 222 222 0 0 0;#P flonum 334 414 42 9 0 0 0 3 0 0 0 221 221 221 222 222 222 0 0 0;#P flonum 274 414 42 9 0 0 0 3 0 0 0 221 221 221 222 222 222 0 0 0;#P number 214 414 35 9 0 0 0 3 0 0 0 221 221 221 222 222 222 0 0 0;#P number 154 414 38 9 0 0 0 3 0 0 0 221 221 221 222 222 222 0 0 0;#P number 94 414 41 9 0 0 0 3 0 0 0 221 221 221 222 222 222 0 0 0;#P window linecount 1;#P newex 34 435 370 196617 v.colourfilter;#P window linecount 2;#P comment 401 387 49 196617 b or v tolerance;#P comment 104 387 41 196617 r or y center;#P comment 308 223 190 196617 r \, g \, b \, and y centers are from 0 - 255. u and v centers are from -128 - 127;#P window linecount 1;#P comment 461 269 152 196617 usual tolerance settings:;#P window linecount 2;#P comment 77 542 560 196617 YUV offers better tracking of colours in highlight and shadow since it separates colour from brightness. To track an object with many levels of brightness \, use a very high y (brightness) tolerance and low (1-4) u and v tolerances).;#P window linecount 4;#P comment 77 459 313 196617 choose_colour < x > < y > < range > allows you to tell v.colourfilter to use the pixels at a location in the image to define the tracking colour. The range value defines how wide a set of pixels around the x \, y point to sample;#P window linecount 1;#P comment 461 301 152 196617 RGB: r \, g \, b tolerance = 4 - 16;#P comment 606 285 109 196617 u \, v tolerance = 1 - 8;#P comment 498 285 110 196617 y tolerance = 4 - 256;#P comment 461 284 34 196617 YUV:;#P window linecount 2;#P comment 406 431 184 196617 the right outlet outputs a list defining the colour at the 'choose_colour' pixel;#P window linecount 1;#P newex 55 584 97 196617 s $1-out;#B color 13;#N comlet vns stream out;#P outlet 34 585 15 0;#P newex 53 21 97 196617 r $1-in;#B color 13;#P toggle 336 75 15 0;#P newex 336 35 67 196617 loadmess $3;#P newex 336 55 31 196617 == 0;#P newex 336 94 38 196617 gate 1;#P newex 336 115 80 196617 s $1-init;#B color 11;#P newex 364 74 70 196617 r camtrk-init;#B color 11;#P window setfont Times 9.;#P window linecount 3;#P comment 412 575 136 1310729 arg 1 : prefix name \; arg 2 : perform jitvns test (1/0) \; arg 3 : disable global init (1/0);#P window setfont "Sans Serif" 9.;#P window linecount 1;#P newex 470 37 80 196617 r $1-init;#B color 11;#P window linecount 9;#P message 470 58 129 196617 \; $1-sw 0 \; $1-choose_colour_size 4 \; $1-ry_center 0 \; $1-gu_center 0 \; $1-bv_center 0 \; $1-ry_tolerance 4 \; $1-gu_tolerance 4 \; $1-bv_tolerance 4 \;;#P toggle 194 155 15 0;#P window linecount 1;#P newex 194 173 31 196617 == 0;#P newex 194 135 124 196617 r $1-sw;#B color 11;#P message 194 193 55 196617 bypass \$1;#P window setfont "Sans Serif" 24.;#P comment 235 575 155 196632 v.colourfilter;#N comlet vns stream in;#P inlet 34 23 15 0;#P connect 0 0 29 0;#P fasten 40 0 29 0 62 162 39 162;#P fasten 2 0 29 0 199 216 39 216;#P fasten 15 0 29 0 58 54 39 54;#P connect 29 0 16 0;#P connect 29 0 17 0;#P connect 0 0 41 0;#P connect 45 0 52 0;#P connect 52 0 30 0;#P connect 30 0 29 1;#P connect 46 0 52 1;#P connect 52 1 31 0;#P connect 31 0 29 2;#P connect 3 0 5 0;#P connect 5 0 4 0;#P connect 4 0 2 0;#P connect 47 0 52 2;#P connect 52 2 32 0;#P connect 32 0 29 3;#P connect 42 0 52 3;#P connect 52 3 33 0;#P connect 33 0 29 4;#P connect 43 0 52 4;#P connect 52 4 34 0;#P connect 34 0 29 5;#P connect 13 0 12 0;#P connect 12 0 14 0;#P connect 14 0 11 0;#P connect 11 0 10 0;#P connect 9 0 11 1;#P connect 44 0 52 5;#P connect 52 5 35 0;#P connect 35 0 29 6;#P connect 29 1 48 0;#P connect 48 0 49 0;#P connect 48 1 50 0;#P connect 7 0 6 0;#P connect 48 2 51 0;#P pop;